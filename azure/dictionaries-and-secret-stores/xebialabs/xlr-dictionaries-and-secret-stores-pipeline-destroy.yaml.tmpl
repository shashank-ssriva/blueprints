{{ $app := .AppName | kebabcase }}
{{ $dir := .AppName | kebabcase }}
apiVersion: xl-release/v1
kind: Templates
spec:
- name: {{$dir}}
  type: xlrelease.Folder
  children:
  - name: {{$app}}-destroy
    type: xlrelease.Release
    description: Destroy the Terraform infrastructure
    tags:
    - {{$app}}
    - Azure
    - Terraform
    scriptUsername: !value XL_RELEASE_USERNAME
    scriptUserPassword: !value XL_RELEASE_PASSWORD
    phases:
    - name: Deprovision Infrastructure
      type: xlrelease.Phase
      color: '#d94c3d'
      tasks:
      - name: Deprovision the VM
        type: xldeploy.Undeploy
        server: XL Deploy
        deployedApplication: "Environments/{{$dir}}/terraform/{{$app}}"
